console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","DisplayFactory","AuthFactory","LoginController","RegisterController","ResetController"]);myApp.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/resetmail",{templateUrl:"views/auth/_resetmail.html",controller:"ResetCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}]),myApp.controller("MainCtrl",["$scope",function(e){}]),myApp.controller("AuthCtrl",["$scope",function(e){}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","DisplayFact","AuthFact",function(e,t,a,r){function s(t){r.loginUser(t,function(t){e.display.alert.usernamedoesntexist=!1,e.display.alert.passwordwrong=!1,t.data.success||("User not found!"==t.data.message&&(e.display.alert.usernamedoesntexist=!0),"Wrong password!"==t.data.message&&(e.display.alert.passwordwrong=!0)),t.data.success&&(e.display.page.form=!1,e.display.page.success=!0)})}e.display={page:{form:!0,success:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1}},e.data={form:{username:"",password:"",rememberme:!1}},e.loginUser=s}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","DisplayFact","AuthFact",function(e,t,a,r){function s(){var t=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);t.test(e.data.form.email)?e.display.alert.emailvalid=!1:e.display.alert.emailvalid=!0}function o(){e.data.form.username<5?e.display.alert.usernametooshort=!0:e.display.alert.usernametooshort=!1}function l(t,a){r.getUsers(t,function(t){e.display.alert.usernametaken=!1,e.display.alert.emailtaken=!1;for(var r=0;r<t.data.length;r++)t.data[r].username==e.data.form.username&&(e.display.alert.usernametaken=!0),t.data[r].email==e.data.form.email&&(e.display.alert.emailtaken=!0);a()})}function n(){e.data.form.password.length<8?e.display.alert.passwordlength=!0:e.display.alert.passwordlength=!1}function i(){e.data.form.password!=e.data.form.passwordconfirm?e.display.alert.passwordsmatching=!0:e.display.alert.passwordsmatching=!1}function d(){return 0==e.display.alert.emailvalid&&0==e.display.alert.emailtaken&&0==e.display.alert.usernametaken&&0==e.display.alert.usernametooshort&&0==e.display.alert.passwordlength&&0==e.display.alert.passwordsmatching?!0:!1}function c(t){o(),s(),n(),i(),l(t,function(){d()&&r.registerUser(t,function(t){t.data.success?a.showSelectedElement(e.display.page,"success"):a.showSelectedElement(e.display.page,"error")})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,emailtaken:!1,usernametaken:!1,usernametooshort:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""}},e.registerUser=c}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","DisplayFact","AuthFact",function(e,t,a,r,s){function o(){e.data.form.reset.newpassword.length<8?e.display.alert.passwordlength=!0:e.display.alert.passwordlength=!1}function l(){e.data.form.reset.newpassword!=e.data.form.reset.confirmnewpassword?e.display.alert.passwordsmatching=!0:e.display.alert.passwordsmatching=!1}function n(){return 0==e.display.alert.passwordlength&&0==e.display.alert.passwordsmatching?!0:!1}function i(t){s.getResetMail(t,function(t){t.data.success&&r.showSelectedElement(e.display.page.resetmail,"success"),t.data.success||r.showSelectedElement(e.display.page.resetmail,"error")})}function d(t){t.encrypteduserdata=a.encrypteduserdata,o(),l(),n()&&s.resetPassword(t,function(t){t.data.success&&r.showSelectedElement(e.display.page.reset,"success"),t.data.success||r.showSelectedElement(e.display.page.reset,"error")})}e.display={page:{resetmail:{form:!0,success:!1,error:!1},reset:{form:!0,success:!1,error:!1}},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{resetmail:{email:""},reset:{newpassword:"",confirmnewpassword:""}}},e.getResetMail=i,e.resetPassword=d}]);var AuthFactory=angular.module("AuthFactory",[]);AuthFactory.factory("AuthFact",["$http",function(e){function t(t,a){e.post("/auth/users",t).then(function(e){a(e)})}function a(t,a){e.post("/auth/login",t).then(function(e){a(e)})}function r(t,a){e.post("/auth/register",t).then(function(e){a(e)})}function s(t,a){e.post("/auth/resetmail",t).then(function(e){a(e)})}function o(t,a){e.post("/auth/reset",t).then(function(e){a(e)})}return{getUsers:t,loginUser:a,registerUser:r,getResetMail:s,resetPassword:o}}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("DisplayFact",[function(){function e(e,t){for(var a in e)a==t?e[a]=!0:e[a]=!1}return{showSelectedElement:e}}]);