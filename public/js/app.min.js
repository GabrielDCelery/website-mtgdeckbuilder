console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","DisplayFactory","AuthFactory","FormValidationFactory","LoginController","RegisterController","ResetController","ResetMailController"]);myApp.config(["$routeProvider","$locationProvider",function(e,a){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/resetmail",{templateUrl:"views/auth/_resetmail.html",controller:"ResetMailCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).otherwise({redirectTo:"/"}),a.html5Mode(!0)}]),myApp.controller("MainCtrl",["$scope",function(e){}]),myApp.controller("AuthCtrl",["$scope",function(e){}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","DisplayFact","AuthFact","FormValidation",function(e,a,t,r,s){function o(a){r.loginUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=o}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","DisplayFact","AuthFact","FormValidation",function(e,a,t,r,s){function o(a,t){r.getUsers(a,function(a){e.display.alert.usernametaken=!1,e.display.alert.emailtaken=!1;for(var r=0;r<a.data.length;r++)a.data[r].username==e.data.form.username&&(e.display.alert.usernametaken=!0),a.data[r].email==e.data.form.email&&(e.display.alert.emailtaken=!0);t()})}function n(a){e.display.alert.emailvalid=s.isEmailValid(e.data.form.email),e.display.alert.usernametooshort=s.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=s.isInputLongEnough(e.data.form.password,8),e.display.alert.passwordsmatching=s.areInputsMatching(e.data.form.password,e.data.form.passwordconfirm),o(a,function(){s.canSendData(e.display.alert)&&r.registerUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,emailtaken:!1,usernametaken:!1,usernametooshort:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=n}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","DisplayFact","AuthFact","FormValidation",function(e,a,t,r,s,o){function n(a){a.encrypteduserdata=t.encrypteduserdata,e.display.alert.passwordlength=o.isInputLongEnough(e.data.form.newpassword,8),e.display.alert.passwordsmatching=o.areInputsMatching(e.data.form.newpassword,e.data.form.confirmnewpassword),o.canSendData(e.display.alert)&&s.resetPassword(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,r.showSelectedElement(e.display.page,"error"))})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{newpassword:"",confirmnewpassword:""},success:{message:""},error:{message:""}},e.resetPassword=n}]);var ResetMailController=angular.module("ResetMailController",[]);ResetMailController.controller("ResetMailCtrl",["$scope","$http","$routeParams","DisplayFact","AuthFact","FormValidation",function(e,a,t,r,s,o){function n(a){s.getResetMail(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:""},success:{message:""},error:{message:""}},e.getResetMail=n}]);var AuthFactory=angular.module("AuthFactory",[]);AuthFactory.factory("AuthFact",["$http",function(e){function a(a,t){e.post("/auth/users",a).then(function(e){t(e)})}function t(a,t){e.post("/auth/login",a).then(function(e){t(e)})}function r(a,t){e.post("/auth/register",a).then(function(e){t(e)})}function s(a,t){e.post("/auth/resetmail",a).then(function(e){t(e)})}function o(a,t){e.post("/auth/reset",a).then(function(e){t(e)})}return{getUsers:a,loginUser:t,registerUser:r,getResetMail:s,resetPassword:o}}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("DisplayFact",[function(){function e(e,a){for(var t in e)t==a?e[t]=!0:e[t]=!1}return{showSelectedElement:e}}]);var FormValidationFactory=angular.module("FormValidationFactory",[]);FormValidationFactory.factory("FormValidation",[function(){function e(e){var a=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);return a.test(e)?!1:!0}function a(e,a){return e.length<a?!0:!1}function t(e,a){return e!=a?!0:!1}function r(e){var a=!0;for(var t in e)1==e[t]&&(a=!1);return a?!0:void 0}return{isEmailValid:e,isInputLongEnough:a,areInputsMatching:t,canSendData:r}}]);