console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","DisplayFactory","AuthFactory","LoginController","RegisterController","ResetController"]);myApp.config(["$routeProvider","$locationProvider",function(e,a){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/resetmail",{templateUrl:"views/auth/_resetmail.html",controller:"ResetCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).otherwise({redirectTo:"/"}),a.html5Mode(!0)}]),myApp.controller("MainCtrl",["$scope",function(e){}]),myApp.controller("AuthCtrl",["$scope",function(e){}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","DisplayFact","AuthFact",function(e,a,s,t){function r(a){t.loginUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,s.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=r}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","DisplayFact","AuthFact",function(e,a,s,t){function r(){var a=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);a.test(e.data.form.email)?e.display.alert.emailvalid=!1:e.display.alert.emailvalid=!0}function o(){e.data.form.username<5?e.display.alert.usernametooshort=!0:e.display.alert.usernametooshort=!1}function l(a,s){t.getUsers(a,function(a){e.display.alert.usernametaken=!1,e.display.alert.emailtaken=!1;for(var t=0;t<a.data.length;t++)a.data[t].username==e.data.form.username&&(e.display.alert.usernametaken=!0),a.data[t].email==e.data.form.email&&(e.display.alert.emailtaken=!0);s()})}function n(){e.data.form.password.length<8?e.display.alert.passwordlength=!0:e.display.alert.passwordlength=!1}function i(){e.data.form.password!=e.data.form.passwordconfirm?e.display.alert.passwordsmatching=!0:e.display.alert.passwordsmatching=!1}function c(){return 0==e.display.alert.emailvalid&&0==e.display.alert.emailtaken&&0==e.display.alert.usernametaken&&0==e.display.alert.usernametooshort&&0==e.display.alert.passwordlength&&0==e.display.alert.passwordsmatching?!0:!1}function d(a){o(),r(),n(),i(),l(a,function(){c()&&t.registerUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,s.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,emailtaken:!1,usernametaken:!1,usernametooshort:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=d}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","DisplayFact","AuthFact",function(e,a,s,t,r){function o(){e.data.form.reset.newpassword.length<8?e.display.alert.passwordlength=!0:e.display.alert.passwordlength=!1}function l(){e.data.form.reset.newpassword!=e.data.form.reset.confirmnewpassword?e.display.alert.passwordsmatching=!0:e.display.alert.passwordsmatching=!1}function n(){return 0==e.display.alert.passwordlength&&0==e.display.alert.passwordsmatching?!0:!1}function i(a){r.getResetMail(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page.resetmail,"success")):(e.data.error.message=a.data.message,e.display.page.resetmail.error=!0)})}function c(a){a.encrypteduserdata=s.encrypteduserdata,o(),l(),n()&&r.resetPassword(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page.reset,"success")):(e.data.error.message=a.data.message,t.showSelectedElement(e.display.page.reset,"error"))})}e.display={page:{resetmail:{form:!0,success:!1,error:!1},reset:{form:!0,success:!1,error:!1}},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{resetmail:{email:""},reset:{newpassword:"",confirmnewpassword:""}},success:{message:""},error:{message:""}},e.getResetMail=i,e.resetPassword=c}]);var AuthFactory=angular.module("AuthFactory",[]);AuthFactory.factory("AuthFact",["$http",function(e){function a(a,s){e.post("/auth/users",a).then(function(e){s(e)})}function s(a,s){e.post("/auth/login",a).then(function(e){s(e)})}function t(a,s){e.post("/auth/register",a).then(function(e){s(e)})}function r(a,s){e.post("/auth/resetmail",a).then(function(e){s(e)})}function o(a,s){e.post("/auth/reset",a).then(function(e){s(e)})}return{getUsers:a,loginUser:s,registerUser:t,getResetMail:r,resetPassword:o}}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("DisplayFact",[function(){function e(e,a){for(var s in e)s==a?e[s]=!0:e[s]=!1}return{showSelectedElement:e}}]);