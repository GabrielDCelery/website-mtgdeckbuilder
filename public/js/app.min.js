console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","DisplayFactory","AuthFactory","LoginController","RegisterController","ResetController"]);myApp.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/resetmail",{templateUrl:"views/auth/_resetmail.html",controller:"ResetCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}]),myApp.controller("MainCtrl",["$scope",function(e){}]),myApp.controller("AuthCtrl",["$scope",function(e){}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","DisplayFact","AuthFact",function(e,t,a,s){function r(t){s.loginUser(t,function(t){t.data.success?(e.data.success.message=t.data.message,a.showSelectedElement(e.display.page,"success")):(e.data.error.message=t.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=r}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","DisplayFact","AuthFact",function(e,t,a,s){function r(){var t=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);t.test(e.data.form.email)?e.display.alert.emailvalid=!1:e.display.alert.emailvalid=!0}function o(){e.data.form.username<5?e.display.alert.usernametooshort=!0:e.display.alert.usernametooshort=!1}function l(t,a){s.getUsers(t,function(t){e.display.alert.usernametaken=!1,e.display.alert.emailtaken=!1;for(var s=0;s<t.data.length;s++)t.data[s].username==e.data.form.username&&(e.display.alert.usernametaken=!0),t.data[s].email==e.data.form.email&&(e.display.alert.emailtaken=!0);a()})}function n(){e.data.form.password.length<8?e.display.alert.passwordlength=!0:e.display.alert.passwordlength=!1}function i(){e.data.form.password!=e.data.form.passwordconfirm?e.display.alert.passwordsmatching=!0:e.display.alert.passwordsmatching=!1}function c(){return 0==e.display.alert.emailvalid&&0==e.display.alert.emailtaken&&0==e.display.alert.usernametaken&&0==e.display.alert.usernametooshort&&0==e.display.alert.passwordlength&&0==e.display.alert.passwordsmatching?!0:!1}function d(t){o(),r(),n(),i(),l(t,function(){c()&&s.registerUser(t,function(t){t.data.success?(e.data.success.message=t.data.message,a.showSelectedElement(e.display.page,"success")):(e.data.error.message=t.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,emailtaken:!1,usernametaken:!1,usernametooshort:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=d}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","DisplayFact","AuthFact",function(e,t,a,s,r){function o(){e.data.form.reset.newpassword.length<8?e.display.alert.passwordlength=!0:e.display.alert.passwordlength=!1}function l(){e.data.form.reset.newpassword!=e.data.form.reset.confirmnewpassword?e.display.alert.passwordsmatching=!0:e.display.alert.passwordsmatching=!1}function n(){return 0==e.display.alert.passwordlength&&0==e.display.alert.passwordsmatching?!0:!1}function i(t){r.getResetMail(t,function(t){t.data.success&&s.showSelectedElement(e.display.page.resetmail,"success"),t.data.success||s.showSelectedElement(e.display.page.resetmail,"error")})}function c(t){t.encrypteduserdata=a.encrypteduserdata,o(),l(),n()&&r.resetPassword(t,function(t){t.data.success&&s.showSelectedElement(e.display.page.reset,"success"),t.data.success||s.showSelectedElement(e.display.page.reset,"error")})}e.display={page:{resetmail:{form:!0,success:!1,error:!1},reset:{form:!0,success:!1,error:!1}},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{resetmail:{email:""},reset:{newpassword:"",confirmnewpassword:""}}},e.getResetMail=i,e.resetPassword=c}]);var AuthFactory=angular.module("AuthFactory",[]);AuthFactory.factory("AuthFact",["$http",function(e){function t(t,a){e.post("/auth/users",t).then(function(e){a(e)})}function a(t,a){e.post("/auth/login",t).then(function(e){a(e)})}function s(t,a){e.post("/auth/register",t).then(function(e){a(e)})}function r(t,a){e.post("/auth/resetmail",t).then(function(e){a(e)})}function o(t,a){e.post("/auth/reset",t).then(function(e){a(e)})}return{getUsers:t,loginUser:a,registerUser:s,getResetMail:r,resetPassword:o}}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("DisplayFact",[function(){function e(e,t){for(var a in e)a==t?e[a]=!0:e[a]=!1}return{showSelectedElement:e}}]);