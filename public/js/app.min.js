console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","ngStorage","DisplayFactory","UsersFactory","FormValidationFactory","AuthController","LoginController","RegisterController","ResetController","ResetMailController"]);myApp.config(["$routeProvider","$locationProvider",function(e,a){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/reset",{templateUrl:"views/auth/_resetmail.html",controller:"ResetMailCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).otherwise({redirectTo:"/"}),a.html5Mode(!0)}]),myApp.controller("MainCtrl",["$scope",function(e){}]);var AuthController=angular.module("AuthController",[]);AuthController.controller("AuthCtrl",["$scope","$location","$localStorage","Users",function(e,a,r,t){function s(a){a&&t.loginWithToken(a,function(a){a.data.success&&(e.auth.loggedIn=!0,e.auth.username=a.data.username)})}function o(){e.auth.loggedIn=!1,e.auth.username="",delete r.token,a.path("/")}e.auth={loggedIn:!1,username:""},e.logOut=o,s(r.token)}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","$localStorage","Display","Users","FormValidation",function(e,a,r,t,s,o){function n(a){e.display.alert.usernamelength=o.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=o.isInputLongEnough(e.data.form.password,8),o.canSendData(e.display.alert)&&s.loginUser(a,function(a){e.auth.username=e.data.form.username,r.token=a.data.token,a.data.success?(e.data.success.message=a.data.message,e.auth.loggedIn=!0,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamelength:!1,passwordlength:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=n}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","Display","Users","FormValidation",function(e,a,r,t,s){function o(a,r){t.doesUserExist(a,function(a){a.data.success?(e.display.page.error=!1,r()):(e.display.page.error=!0,e.data.error.message=a.data.message)})}function n(a){e.display.alert.emailvalid=s.isEmailValid(e.data.form.email),e.display.alert.usernamelength=s.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=s.isInputLongEnough(e.data.form.password,8),e.display.alert.passwordsmatching=s.areInputsMatching(e.data.form.password,e.data.form.passwordconfirm),o(a,function(){s.canSendData(e.display.alert)&&t.registerUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,usernamelength:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=n}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","Display","Users","FormValidation",function(e,a,r,t,s,o){function n(a){a.encrypteduserdata=r.encrypteduserdata,e.display.alert.passwordlength=o.isInputLongEnough(e.data.form.newpassword,8),e.display.alert.passwordsmatching=o.areInputsMatching(e.data.form.newpassword,e.data.form.confirmnewpassword),o.canSendData(e.display.alert)&&s.resetPassword(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,t.showSelectedElement(e.display.page,"error"))})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{newpassword:"",confirmnewpassword:""},success:{message:""},error:{message:""}},e.resetPassword=n}]);var ResetMailController=angular.module("ResetMailController",[]);ResetMailController.controller("ResetMailCtrl",["$scope","$http","$routeParams","Display","Users","FormValidation",function(e,a,r,t,s,o){function n(a){e.display.alert.emailvalid=o.isEmailValid(e.data.form.email),o.canSendData(e.display.alert)&&s.getResetMail(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1}},e.data={form:{email:""},success:{message:""},error:{message:""}},e.getResetMail=n}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("Display",[function(){function e(e,a){for(var r in e)r==a?e[r]=!0:e[r]=!1}return{showSelectedElement:e}}]);var FormValidationFactory=angular.module("FormValidationFactory",[]);FormValidationFactory.factory("FormValidation",[function(){function e(e){var a=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);return a.test(e)?!1:!0}function a(e,a){return e.length<a?!0:!1}function r(e,a){return e!=a?!0:!1}function t(e){var a=!0;for(var r in e)1==e[r]&&(a=!1);return a?!0:void 0}return{isEmailValid:e,isInputLongEnough:a,areInputsMatching:r,canSendData:t}}]);var UsersFactory=angular.module("UsersFactory",[]);UsersFactory.factory("Users",["$http",function(e){function a(a,r){e.post("/auth/doesuserexist",a).then(function(e){r(e)})}function r(a,r){e.post("/auth/login",a).then(function(e){r(e)})}function t(a,r){e.post("/auth/register",a).then(function(e){r(e)})}function s(a,r){e.post("/auth/resetmail",a).then(function(e){r(e)})}function o(a,r){e.post("/auth/reset",a).then(function(e){r(e)})}function n(a,r){e.post("/auth/token",{token:a}).then(function(e){r(e)})}return{doesUserExist:a,loginUser:r,registerUser:t,getResetMail:s,resetPassword:o,loginWithToken:n}}]);